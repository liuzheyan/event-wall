// å…¨å±€é…ç½®æ–‡ä»¶

/** ===== åŸºç¡€é…ç½® ===== */
const CONFIG = {
  // å¼¹å¹•æœ€å¤§é•¿åº¦
  MAX_LEN: 30,
  // å‘é€å†·å´æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
  SEND_INTERVAL: 3000,
  // å¼¹å¹•è½¨é“æ•°é‡
  TRACK_COUNT: 6,
  // è½¨é“é«˜åº¦
  TRACK_HEIGHT: 56,
  // èƒŒæ™¯å›¾
  // BG_IMAGE: "https://images.unsplash.com/photo-1514525253161-7a46d19cd819",
  BG_IMAGE: "img/photo.jpg",
  
  // === æ–°å¢éœ€æ±‚é…ç½® ===
  // å¾ªç¯å›æ”¾æ£€æŸ¥é—´éš”ï¼ˆé»˜è®¤3åˆ†é’Ÿ = 180000msï¼‰
  REPLAY_INTERVAL: 3 * 60 * 1000,
  // è§¦å‘å¾ªç¯å›æ”¾çš„é˜ˆå€¼ï¼ˆç”¨æˆ·å¼¹å¹•å°‘äºæ­¤æ•°é‡æ—¶è§¦å‘ï¼‰
  REPLAY_THRESHOLD: 50
};

/** ===== è¿ç¦è¯åº“ï¼ˆå·²æ‰©å±•ï¼‰ ===== */
const FORBIDDEN_WORDS = [
  // åŸºç¡€è¾±éª‚
  "å‚»é€¼", "sb", "SB", "è‰æ³¥é©¬", "å¦ˆçš„", "ä½ å¦ˆ", "å°¼ç›", "å‚»X", "ç…ç¬”", "æ™ºéšœ", "å¼±æ™º",
  "åƒåœ¾", "åºŸç‰©", "æ»š", "å»æ­»", "åƒå±", "è„‘æ®‹",
  // é’ˆå¯¹å…¬å¸/é¢†å¯¼
  "é¢†å¯¼å‚»", "å…¬å¸åƒåœ¾", "è£å‘˜", "å€’é—­", "å‘çˆ¹", "å¸è¡€", "å‰¥å‰Š", "é»‘å¿ƒ",
  // æ•æ„Ÿè¯é¢˜
  "é»„è‰²", "èµŒåš", "è‰²æƒ…", "åšçˆ±", "çº¦ç‚®", "è£¸èŠ", "AV",
  "æ”¿æ²»", "æ”¿åºœ", "å…±äº§å…š" // ç®€å•ç¤ºä¾‹ï¼Œå®é™…éœ€æŒ‰éœ€æ‰©å……
];

/** ===== é»˜è®¤å¹´ä¼šå¼¹å¹•åº“ ===== */
const DEFAULT_DANMU = [
  "ğŸ‰ å¹´ä¼šæ­£å¼å¼€å§‹å•¦ï¼",
  "ğŸ‘ è¾›è‹¦ä¸€å¹´ï¼ŒæŒå£°é€ç»™è‡ªå·±",
  "âœ¨ ä»Šæ™šä¸åŠ ç­ï¼ŒåªåŠ å¿«ä¹",
  "ğŸ¥‚ æ¬¢è¿æ¥åˆ°æˆ‘ä»¬çš„å¹´ä¼šç°åœº",
  "ğŸ”¥ æ°›å›´ç»„å·²å°±ä½ï¼",
  "ğŸ˜„ ä»Šå¤©çš„å…³é”®è¯ï¼šå¼€å¿ƒ",
  "ğŸš€ æ–°çš„ä¸€å¹´ä¸€èµ·å†²ï¼",
  "ğŸ’¼ æ„Ÿè°¢æ¯ä¸€ä½åŒäº‹çš„ä»˜å‡º",
  "ğŸŠ å¹´ä¼šæ°›å›´æ‹‰æ»¡ï¼",
  "ğŸ™Œ å…¨å‘˜é›†åˆï¼Œå‡†å¤‡å—¨ï¼",
  "ğŸ æŠ½å¥–é©¬ä¸Šå¼€å§‹ï¼Œç¥å¤§å®¶å¥½è¿",
  "ğŸ€ é”¦é²¤å°±åœ¨ç°åœº",
  "ğŸ˜ æ‰‹æ°”è¿™ç§äº‹ï¼Œè¯´æ¥å°±æ¥",
  "ğŸ§§ å¸Œæœ›ä¸‹ä¸€ä½æ˜¯æˆ‘",
  "ğŸ¤ å·²ç»å¼€å§‹é»˜é»˜è®¸æ„¿",
  "ğŸª„ å¥½è¿æ­£åœ¨åŠ è½½ä¸­â€¦",
  "ğŸ¯ æŠ½å¥–å°±æ˜¯å¿ƒè·³åŠ é€Ÿå™¨",
  "ğŸ¥³ æ­å–œæ‰€æœ‰ä¸­å¥–çš„å°ä¼™ä¼´",
  "ğŸ˜­ æ²¡ä¸­å¥–ä¹Ÿè¦ä¿æŒå¾®ç¬‘",
  "ğŸ é‡åœ¨å‚ä¸ï¼Œå¼€å¿ƒæœ€é‡è¦",
  "ğŸ’ª å›¢é˜Ÿåä½œï¼Œå¤©ä¸‹æ— æ•Œ",
  "ğŸŒŸ æ¯ä¸€ä»½åŠªåŠ›éƒ½å€¼å¾—è¢«çœ‹è§",
  "ğŸ† ä¸ºä¼˜ç§€çš„åŒäº‹ç‚¹èµ",
  "ğŸ¤ æ„Ÿè°¢å¹¶è‚©ä½œæˆ˜çš„ä¼™ä¼´ä»¬",
  "ğŸ§  ä»Šå¤©ä¸èŠ KPI",
  "ğŸ’¡ æ˜å¤©ç»§ç»­å‘å…‰",
  "ğŸ—ï¸ ä¸€èµ·æŠŠäº‹æƒ…åšå¥½",
  "ğŸŒˆ æœªæ¥å¯æœŸ",
  "ğŸ“ˆ è¶Šæ¥è¶Šå¥½ï¼Œä¸æ˜¯å£å·",
  "ğŸ¥‡ æˆ‘ä»¬æ˜¯æœ€æ£’çš„å›¢é˜Ÿ",
  "ğŸ˜„ æ°”æ°›å·²ç»åˆ°ä½",
  "ğŸ¥‚ ä»Šæ™šä¸è°ˆå·¥ä½œ",
  "ğŸ’¤ æ˜å¤©çš„äº‹æ˜å¤©å†è¯´",
  "ğŸ¶ éŸ³ä¹ä¸€å“ï¼Œå¿«ä¹ç™»åœº",
  "ğŸ˜† å¼¹å¹•æ¯”æˆ‘ååº”å¿«",
  "ğŸ‘€ å¤§å±å¹•å¥½çƒ­é—¹",
  "ğŸˆ æ°›å›´æ­£åœ¨å‡æ¸©",
  "ğŸ«¶ å¿«ä¹æ˜¯ä¼šä¼ æŸ“çš„",
  "ğŸ˜ è¿™å°±æ˜¯å¹´ä¼šçš„æ„Ÿè§‰",
  "ğŸŒ™ ä»Šæ™šå€¼å¾—è®°ä½",
  "ğŸ† ç²¾å½©è¿˜åœ¨ç»§ç»­",
  "ğŸ™ æ„Ÿè°¢æ‰€æœ‰å¹•åå·¥ä½œäººå‘˜",
  "ğŸ‰ ä»Šå¹´ä¹Ÿè¾›è‹¦å¤§å®¶äº†",
  "ğŸ’– æŠŠæŒå£°é€ç»™å½¼æ­¤",
  "ğŸŒŸ è¿™ä¸€åˆ»å¾ˆçè´µ",
  "ğŸŠ å¿«ä¹è¯·ç»§ç»­",
  "ğŸ¥° ä»Šå¤©çœŸçš„å¾ˆå¼€å¿ƒ",
  "ğŸš€ æ–°ä¸€å¹´ï¼Œä¸€èµ·æ›´å¥½",
  "ğŸ» ä¸ºè¿™ä¸€å¹´å¹²æ¯",
  "ğŸ‰ å¹´ä¼šåœ†æ»¡è¿›è¡Œä¸­ï¼"
];

/** ===== å·¥å…·å‡½æ•°ï¼šæ–‡æœ¬è¿‡æ»¤ ===== */
function filterText(text) {
  let result = text;
  FORBIDDEN_WORDS.forEach(word => {
    // ç®€å•çš„æ­£åˆ™æ›¿æ¢ï¼Œæ³¨æ„ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰é—®é¢˜ï¼Œè¿™é‡Œç®€åŒ–å¤„ç†
    try {
      const reg = new RegExp(word, "ig");
      result = result.replace(reg, "***");
    } catch (e) {
      // å¿½ç•¥æ­£åˆ™é”™è¯¯
    }
  });
  return result;
}
